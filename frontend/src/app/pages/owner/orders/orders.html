<app-navbar role="owner"></app-navbar>

<div class="px-6 py-4">

  <!-- TOP FILTER BAR -->
  <div class="flex justify-center mb-6">
    <div class="flex items-center gap-4 flex-wrap">

      <button
        (click)="setFilter('all')"
        [ngClass]="activeFilter === 'all' ? 'border-[#9B1C1F] text-[#9B1C1F]' : 'border-gray-300'"
        class="px-4 py-2 rounded-xl border font-medium transition bg-white hover:border-[#9B1C1F]"
        type="button"
      >
        All Orders
      </button>

      <button
        (click)="setFilter('new')"
        [ngClass]="activeFilter === 'new' ? 'border-[#9B1C1F] text-[#9B1C1F]' : 'border-gray-300'"
        class="px-4 py-2 rounded-xl border transition bg-white hover:border-[#9B1C1F]"
        type="button"
      >
        New Order
      </button>

      <button
        (click)="setFilter('preparing')"
        [ngClass]="activeFilter === 'preparing' ? 'border-[#9B1C1F] text-[#9B1C1F]' : 'border-gray-300'"
        class="px-4 py-2 rounded-xl border transition bg-white hover:border-[#9B1C1F]"
        type="button"
      >
        Preparing
      </button>

      <button
        (click)="setFilter('ready')"
        [ngClass]="activeFilter === 'ready' ? 'border-[#9B1C1F] text-[#9B1C1F]' : 'border-gray-300'"
        class="px-4 py-2 rounded-xl border transition bg-white hover:border-[#9B1C1F]"
        type="button"
      >
        Ready
      </button>

      <button
        (click)="setFilter('complete')"
        [ngClass]="activeFilter === 'complete' ? 'border-[#9B1C1F] text-[#9B1C1F]' : 'border-gray-300'"
        class="px-4 py-2 rounded-xl border transition bg-white hover:border-[#9B1C1F]"
        type="button"
      >
        Complete
      </button>

      <!-- SEARCH -->
      <div class="relative ml-4">
        <input
          [(ngModel)]="searchTerm"
          type="text"
          placeholder="Order ID or Customer Name"
          class="pl-4 pr-10 py-2 rounded-xl border border-gray-300 bg-white
                 focus:border-[#9B1C1F] focus:ring-1 focus:ring-[#9B1C1F]
                 focus:outline-none transition"
        />
        <span class="absolute right-3 top-2.5">üîç</span>
      </div>

    </div>
  </div>

  <!-- ORDERS GRID -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

    <div
      *ngFor="let order of filteredOrders()"
      class="border border-gray-300 rounded-lg overflow-hidden bg-white"
    >

      <!-- HEADER -->
      <div class="bg-[#9B1C1F] text-white px-4 py-2 flex justify-between items-center">
        <span class="font-semibold">{{ order.id }}</span>

        <span
          class="text-xs px-3 py-1 rounded-lg border border-white/70 bg-white/10"
        >
          {{ statusLabel(order.status) }}
        </span>
      </div>

      <!-- BODY -->
      <div class="p-4 space-y-4">

        <div class="flex gap-3 items-start">
          <div class="w-10 h-10 bg-[#9B1C1F]/15 rounded"></div>

          <div>
            <p class="font-medium text-gray-900">{{ order.customerName }}</p>
            <p class="text-sm text-gray-600">{{ order.address }}</p>
          </div>
        </div>

        <div class="bg-[#9B1C1F]/10 p-3 rounded-md border border-[#9B1C1F]/20">
          <p class="font-semibold text-sm mb-1 text-gray-900">ORDER ITEMS</p>
          <ul class="text-sm list-disc ml-4 text-gray-800">
            <li *ngFor="let item of order.items">
              {{ item.quantity }} √ó {{ item.name }}
            </li>
          </ul>
        </div>

      </div>

      <!-- ACTIONS -->
      <div class="flex gap-3 p-4">

        <!-- NEW -->
        <button
          *ngIf="order.status === 'new'"
          (click)="startPreparing(order)"
          class="flex-1 py-2 rounded-full border border-[#9B1C1F] text-[#9B1C1F]
                 hover:bg-[#9B1C1F] hover:text-white transition"
          type="button"
        >
          Start Preparing
        </button>

        <!-- PREPARING -->
        <button
          *ngIf="order.status === 'preparing'"
          (click)="markReady(order)"
          class="flex-1 py-2 rounded-full border border-[#9B1C1F] text-[#9B1C1F]
                 hover:bg-[#9B1C1F] hover:text-white transition"
          type="button"
        >
          Ready
        </button>

        <!-- READY -->
        <button
          *ngIf="order.status === 'ready'"
          (click)="completeOrder(order)"
          class="flex-1 py-2 rounded-full border border-[#9B1C1F] text-[#9B1C1F]
                 hover:bg-[#9B1C1F] hover:text-white transition"
          type="button"
        >
          Complete
        </button>

        <!-- REJECT -->
        <button
          *ngIf="order.status === 'new'"
          (click)="rejectOrder(order.id)"
          class="py-2 px-5 rounded-full border border-gray-400 text-gray-800
                 hover:border-[#9B1C1F] hover:text-[#9B1C1F] transition"
          type="button"
        >
          Reject
        </button>

      </div>

    </div>

    <!-- NO ORDERS -->
    <div
      *ngIf="filteredOrders().length === 0"
      class="col-span-full text-center text-gray-500 mt-10"
    >
      No orders found.
    </div>

  </div>
</div>
